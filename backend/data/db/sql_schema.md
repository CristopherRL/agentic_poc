-- SQLite Schema Overview
-- Generated by scripts/ingest_sql.py
-- This file contains the database schema with table and column comments

-- ===========================================================================
-- Table: DIM_COUNTRY
-- Purpose: Stores geography metadata: 'country' (full name), 'country_code' (ISO-2), and 'region' (e.g., Western Europe).
-- ===========================================================================
CREATE TABLE "DIM_COUNTRY" (
	country TEXT, 
	country_code TEXT, 
	region TEXT
)

-- Sample data:
--   country: "Germany", country_code: "DE", region: "Western Europe"
--   country: "France", country_code: "FR", region: "Western Europe"

-- ===========================================================================
-- Table: DIM_MODEL
-- Purpose: Catalog of vehicles: 'model_id' (unique), 'model_name', 'brand' (Toyota/Lexus), 'segment' (SUV), 'powertrain' (Petrol/HEV/PHEV).
-- ===========================================================================
CREATE TABLE "DIM_MODEL" (
	model_id BIGINT, 
	model_name TEXT, 
	brand TEXT, 
	segment TEXT, 
	powertrain TEXT
)

-- Sample data:
--   model_id: 100, model_name: "RAV4", brand: "Toyota", segment: "SUV", powertrain: "HEV"
--   model_id: 101, model_name: "RAV4", brand: "Toyota", segment: "SUV", powertrain: "PHEV"

-- ===========================================================================
-- Table: DIM_ORDERTYPE
-- Purpose: Order classifications: 'ordertype_id' (unique), 'ordertype_name' (Private/Fleet/Demo), 'description' (B2C/B2B/Dealer demo).
-- ===========================================================================
CREATE TABLE "DIM_ORDERTYPE" (
	ordertype_id BIGINT, 
	ordertype_name TEXT, 
	description TEXT
)

-- Sample data:
--   ordertype_id: 1, ordertype_name: "Private", description: "B2C personal purchase"
--   ordertype_id: 2, ordertype_name: "Fleet", description: "B2B company fleet"

-- ===========================================================================
-- Table: FACT_SALES
-- Purpose: Core fact table of sales: 'model_id' -> DIM_MODEL, 'country_code' -> DIM_COUNTRY, plus 'year', 'month', 'contracts' (units sold).
-- ===========================================================================
CREATE TABLE "FACT_SALES" (
	model_id BIGINT, 
	country_code TEXT, 
	year BIGINT, 
	month BIGINT, 
	contracts BIGINT
)

-- Sample data:
--   model_id: 100, country_code: "DE", year: 2023, month: 1, contracts: 77
--   model_id: 100, country_code: "DE", year: 2023, month: 2, contracts: 88

-- ===========================================================================
-- Table: FACT_SALES_ORDERTYPE
-- Purpose: Sales by order type: same keys as FACT_SALES plus 'ordertype_id' -> DIM_ORDERTYPE.
-- ===========================================================================
CREATE TABLE "FACT_SALES_ORDERTYPE" (
	model_id BIGINT, 
	country_code TEXT, 
	year BIGINT, 
	month BIGINT, 
	contracts BIGINT, 
	ordertype_id BIGINT
)

-- Sample data:
--   model_id: 100, country_code: "DE", year: 2023, month: 1, contracts: 77, ordertype_id: 1
--   model_id: 100, country_code: "DE", year: 2023, month: 2, contracts: 88, ordertype_id: 1

-- ===========================================================================
-- Relationships:
-- ===========================================================================
-- FACT_SALES.model_id -> DIM_MODEL.model_id
-- FACT_SALES.country_code -> DIM_COUNTRY.country_code
-- FACT_SALES_ORDERTYPE.model_id -> DIM_MODEL.model_id
-- FACT_SALES_ORDERTYPE.country_code -> DIM_COUNTRY.country_code
-- FACT_SALES_ORDERTYPE.ordertype_id -> DIM_ORDERTYPE.ordertype_id

-- ===========================================================================
-- Sample Data Examples:
-- ===========================================================================
-- DIM_COUNTRY sample rows:
--   {"country": "Germany", "country_code": "DE", "region": "Western Europe"}
--   {"country": "France", "country_code": "FR", "region": "Western Europe"}

-- DIM_MODEL sample rows:
--   {"model_id": 100, "model_name": "RAV4", "brand": "Toyota", "segment": "SUV", "powertrain": "HEV"}
--   {"model_id": 101, "model_name": "RAV4", "brand": "Toyota", "segment": "SUV", "powertrain": "PHEV"}

-- DIM_ORDERTYPE sample rows:
--   {"ordertype_id": 1, "ordertype_name": "Private", "description": "B2C personal purchase"}
--   {"ordertype_id": 2, "ordertype_name": "Fleet", "description": "B2B company fleet"}

-- FACT_SALES sample rows:
--   {"model_id": 100, "country_code": "DE", "year": 2023, "month": 1, "contracts": 77}
--   {"model_id": 100, "country_code": "DE", "year": 2023, "month": 2, "contracts": 88}

-- FACT_SALES_ORDERTYPE sample rows:
--   {"model_id": 100, "country_code": "DE", "year": 2023, "month": 1, "contracts": 77, "ordertype_id": 1}
--   {"model_id": 100, "country_code": "DE", "year": 2023, "month": 2, "contracts": 88, "ordertype_id": 1}
